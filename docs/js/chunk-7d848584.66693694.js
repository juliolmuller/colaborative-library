(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7d848584"],{"02b3":function(t,e,o){"use strict";o.r(e);var i=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"book-details"}},[i("header",[i("ViewTitle",[t._v(" "+t._s(t._f("truncate")("novo"===t.bookId?"Novo Livro":t.book.name,80))+" ")]),t.isEditing?t._e():i("button",{staticClass:"btn btn-sm btn-light",attrs:{type:"button"},on:{click:function(e){return t.$router.go(-1)}}},[i("img",{attrs:{src:o("c012"),alt:"ícone de retornar"}}),t._v(" Voltar ")])],1),i("form",{on:{submit:function(e){return e.preventDefault(),t.handleSubmit(e)}}},[i("div",{staticClass:"row"},[i("div",{staticClass:"col-12 col-md-4"},[i("img",{staticClass:"img-fluid",attrs:{alt:"Capa do livro",src:t.book.image},on:{error:t.fallbackImage}})]),i("div",{staticClass:"col-12 col-md-8"},["novo"!==t.bookId?i("div",{staticClass:"form-group"},[i("label",{attrs:{for:"book-id"}},[t._v("Código de Cadastro:")]),i("input",{directives:[{name:"model",rawName:"v-model.number",value:t.book.id,expression:"book.id",modifiers:{number:!0}}],class:t.inputStyle,attrs:{type:"text",id:"book-id",readonly:""},domProps:{value:t.book.id},on:{input:function(e){e.target.composing||t.$set(t.book,"id",t._n(e.target.value))},blur:function(e){return t.$forceUpdate()}}})]):t._e(),i("div",{staticClass:"form-group"},[i("label",{attrs:{for:"book-name"}},[t._v("Título da Obra:")]),i("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.book.name,expression:"book.name",modifiers:{trim:!0}}],class:t.inputStyle,attrs:{type:"text",id:"book-name",readonly:!t.isEditing,required:"",autofocus:""},domProps:{value:t.book.name},on:{input:function(e){e.target.composing||t.$set(t.book,"name",e.target.value.trim())},blur:function(e){return t.$forceUpdate()}}})]),t.isEditing?i("div",{staticClass:"form-group"},[i("label",{attrs:{for:"book-image"}},[t._v("URL da Capa:")]),i("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.book.image,expression:"book.image",modifiers:{trim:!0}}],class:t.inputStyle,attrs:{type:"text",id:"book-image",readonly:!t.isEditing,required:""},domProps:{value:t.book.image},on:{input:function(e){e.target.composing||t.$set(t.book,"image",e.target.value.trim())},blur:function(e){return t.$forceUpdate()}}})]):t._e(),t.isEditing?t._e():i("div",{staticClass:"form-group"},[i("label",{attrs:{for:"book-owner"}},[t._v("Dono do Livro:")]),i("input",{class:t.inputStyle,attrs:{type:"text",id:"book-owner",readonly:""},domProps:{value:t.owner.name}})]),t.isEditing?t._e():i("div",{staticClass:"form-group"},[i("label",{attrs:{for:"status"}},[t._v("Status:")]),i("input",{class:Object.assign({},t.inputStyle,{"text-hero":!1,"text-success":!t.book.loan,"text-danger":!!t.book.loan}),attrs:{type:"text",id:"status",readonly:""},domProps:{value:t.book.loan?"Emprestado desde "+new Date(t.book.loan.date).toLocaleDateString():"Disponível"}})]),i("div",{staticClass:"action-btn"},[t.isEditing||t.book.loan?t._e():i("button",{staticClass:"btn btn-hero",attrs:{type:"button",disabled:t.isLoading},on:{click:t.handleBorrow}},[t._v("Emprestar Livro")]),!t.isEditing&&t.book.loan&&t.book.loan.userId===t.user.id?i("button",{staticClass:"btn btn-hero",attrs:{type:"button",disabled:t.isLoading},on:{click:t.handleReturn}},[t._v("Devolver Livro")]):t._e(),t.isEditing&&!t.book.loan&&t.owner.id===t.user.id&&"novo"!==t.bookId?i("button",{staticClass:"btn btn-danger mr-auto",attrs:{type:"button",disabled:t.isLoading},on:{click:t.handleDelete}},[t._v("Remover da Estante")]):t._e(),t.book.loan||t.owner.id!==t.user.id||"novo"===t.bookId?t._e():i("button",{class:["btn",t.isEditing?"btn-light":"btn-secondary"],attrs:{type:"button"},on:{click:t.toggleEditing}},[t._v(t._s(t.isEditing?"Cancelar":"Editar Dados"))]),t.isEditing?i("button",{staticClass:"btn btn-hero",attrs:{type:"submit",disabled:t.isLoading}},[t._v("Concluído")]):t._e()])])])])])},n=[],r=(o("5319"),o("2f62")),a=o("ccc1"),s=o("d246"),l=o("1a3b"),c=o.n(l),u={name:"BookDetails",filters:{truncate:a["a"]},components:{ViewTitle:s["a"]},props:{bookId:{type:[Number,String],required:!0}},data:()=>({isLoading:!1,isEditing:!1,dataBackup:{},book:{}}),computed:{...Object(r["c"])({appLoading:"isLoading",books:"books/allBooks",users:"users/allUsers",user:"auth/userData"}),owner(){const t=this.users.find(t=>t.id===this.book.userId)||{},e=this.book.userId===this.user.id;return{...t,name:e?"você":t.name}},inputStyle(){return{"form-control":this.isEditing,"form-control-plaintext":!this.isEditing,"font-weight-bold":!this.isEditing,"text-hero":!this.isEditing}}},watch:{book(t){this.dataBackup={...t}}},methods:{...Object(r["b"])("books",{createBook:"create",updateBook:"update",borrowBook:"borrow",returnBook:"return",deleteBook:"delete"}),toggleEditing(){this.isEditing=!this.isEditing,this.book={...this.dataBackup}},fallbackImage(t){t.target.src=c.a},async handleSubmit(){this.isLoading=!0;try{"novo"===this.bookId?(this.book=await this.createBook(this.book),this.isEditing=!1,this.$router.replace({name:"BookDetails",params:{bookId:this.book.id}})):(await this.updateBook(this.book),this.isEditing=!1)}catch(t){throw t}finally{this.isLoading=!1}},async handleBorrow(){this.isLoading=!0;try{await this.borrowBook(this.book),this.book=this.books.find(({id:t})=>this.bookId===t)}catch(t){throw t}finally{this.isLoading=!1}},async handleReturn(){this.isLoading=!0;try{await this.returnBook(this.book),this.book=this.books.find(({id:t})=>this.bookId===t)}catch(t){throw t}finally{this.isLoading=!1}},async handleDelete(){if(confirm(`Tem certeza de que deseja remover o livro "${this.book.name}" do catálogo?`)){this.isLoading=!0;try{await this.deleteBook(this.book),this.$router.replace({name:"Home"})}catch(t){throw t}finally{this.isLoading=!0}}}},async mounted(){if(await new Promise(t=>{while(this.appLoading);t()}),"novo"===this.bookId)return this.book.userId=this.user.id,this.book.image="https://",this.book.loan=!1,void(this.isEditing=!0);const t=this.books.find(({id:t})=>this.bookId===t);t?this.book={...t}:this.$router.replace({name:"Home"})}},d=u,b=(o("f36d"),o("2877")),f=Object(b["a"])(d,i,n,!1,null,null,null);e["default"]=f.exports},"0a25":function(t,e,o){"use strict";o("af4b")},"0cb2":function(t,e,o){var i=o("7b0b"),n=Math.floor,r="".replace,a=/\$([$&'`]|\d\d?|<[^>]*>)/g,s=/\$([$&'`]|\d\d?)/g;t.exports=function(t,e,o,l,c,u){var d=o+t.length,b=l.length,f=s;return void 0!==c&&(c=i(c),f=a),r.call(u,f,(function(i,r){var a;switch(r.charAt(0)){case"$":return"$";case"&":return t;case"`":return e.slice(0,o);case"'":return e.slice(d);case"<":a=c[r.slice(1,-1)];break;default:var s=+r;if(0===s)return i;if(s>b){var u=n(s/10);return 0===u?i:u<=b?void 0===l[u-1]?r.charAt(1):l[u-1]+r.charAt(1):i}a=l[s-1]}return void 0===a?"":a}))}},"14c3":function(t,e,o){var i=o("c6b6"),n=o("9263");t.exports=function(t,e){var o=t.exec;if("function"===typeof o){var r=o.call(t,e);if("object"!==typeof r)throw TypeError("RegExp exec method returned something other than an Object or null");return r}if("RegExp"!==i(t))throw TypeError("RegExp#exec called on incompatible receiver");return n.call(t,e)}},"1a3b":function(t,e,o){t.exports=o.p+"img/fallback-image.be641a8a.jpg"},5319:function(t,e,o){"use strict";var i=o("d784"),n=o("825a"),r=o("50c4"),a=o("a691"),s=o("1d80"),l=o("8aa5"),c=o("0cb2"),u=o("14c3"),d=Math.max,b=Math.min,f=function(t){return void 0===t?t:String(t)};i("replace",2,(function(t,e,o,i){var g=i.REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE,p=i.REPLACE_KEEPS_$0,h=g?"$":"$0";return[function(o,i){var n=s(this),r=void 0==o?void 0:o[t];return void 0!==r?r.call(o,n,i):e.call(String(n),o,i)},function(t,i){if(!g&&p||"string"===typeof i&&-1===i.indexOf(h)){var s=o(e,t,this,i);if(s.done)return s.value}var v=n(t),m=String(this),k="function"===typeof i;k||(i=String(i));var E=v.global;if(E){var x=v.unicode;v.lastIndex=0}var y=[];while(1){var w=u(v,m);if(null===w)break;if(y.push(w),!E)break;var _=String(w[0]);""===_&&(v.lastIndex=l(m,r(v.lastIndex),x))}for(var I="",C=0,S=0;S<y.length;S++){w=y[S];for(var R=String(w[0]),$=d(b(a(w.index),m.length),0),L=[],B=1;B<w.length;B++)L.push(f(w[B]));var P=w.groups;if(k){var T=[R].concat(L,$,m);void 0!==P&&T.push(P);var A=String(i.apply(void 0,T))}else A=c(R,m,$,L,P,i);$>=C&&(I+=m.slice(C,$)+A,C=$+R.length)}return I+m.slice(C)}]}))},6547:function(t,e,o){var i=o("a691"),n=o("1d80"),r=function(t){return function(e,o){var r,a,s=String(n(e)),l=i(o),c=s.length;return l<0||l>=c?t?"":void 0:(r=s.charCodeAt(l),r<55296||r>56319||l+1===c||(a=s.charCodeAt(l+1))<56320||a>57343?t?s.charAt(l):r:t?s.slice(l,l+2):a-56320+(r-55296<<10)+65536)}};t.exports={codeAt:r(!1),charAt:r(!0)}},"8aa5":function(t,e,o){"use strict";var i=o("6547").charAt;t.exports=function(t,e,o){return e+(o?i(t,e).length:1)}},9263:function(t,e,o){"use strict";var i=o("ad6d"),n=o("9f7f"),r=RegExp.prototype.exec,a=String.prototype.replace,s=r,l=function(){var t=/a/,e=/b*/g;return r.call(t,"a"),r.call(e,"a"),0!==t.lastIndex||0!==e.lastIndex}(),c=n.UNSUPPORTED_Y||n.BROKEN_CARET,u=void 0!==/()??/.exec("")[1],d=l||u||c;d&&(s=function(t){var e,o,n,s,d=this,b=c&&d.sticky,f=i.call(d),g=d.source,p=0,h=t;return b&&(f=f.replace("y",""),-1===f.indexOf("g")&&(f+="g"),h=String(t).slice(d.lastIndex),d.lastIndex>0&&(!d.multiline||d.multiline&&"\n"!==t[d.lastIndex-1])&&(g="(?: "+g+")",h=" "+h,p++),o=new RegExp("^(?:"+g+")",f)),u&&(o=new RegExp("^"+g+"$(?!\\s)",f)),l&&(e=d.lastIndex),n=r.call(b?o:d,h),b?n?(n.input=n.input.slice(p),n[0]=n[0].slice(p),n.index=d.lastIndex,d.lastIndex+=n[0].length):d.lastIndex=0:l&&n&&(d.lastIndex=d.global?n.index+n[0].length:e),u&&n&&n.length>1&&a.call(n[0],o,(function(){for(s=1;s<arguments.length-2;s++)void 0===arguments[s]&&(n[s]=void 0)})),n}),t.exports=s},"9f7f":function(t,e,o){"use strict";var i=o("d039");function n(t,e){return RegExp(t,e)}e.UNSUPPORTED_Y=i((function(){var t=n("a","y");return t.lastIndex=2,null!=t.exec("abcd")})),e.BROKEN_CARET=i((function(){var t=n("^r","gy");return t.lastIndex=2,null!=t.exec("str")}))},ac1f:function(t,e,o){"use strict";var i=o("23e7"),n=o("9263");i({target:"RegExp",proto:!0,forced:/./.exec!==n},{exec:n})},ad6d:function(t,e,o){"use strict";var i=o("825a");t.exports=function(){var t=i(this),e="";return t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.dotAll&&(e+="s"),t.unicode&&(e+="u"),t.sticky&&(e+="y"),e}},af4b:function(t,e,o){},c012:function(t,e,o){t.exports=o.p+"img/left-arrow.4dde86d2.svg"},ccc1:function(t,e,o){"use strict";const i=60,n=(t,e=i,o="...")=>{if(!t||"string"!==typeof t)return t;if(t.length<=e)return t;const n=e-o.length;let r=t.slice(0,n),a=r.length-1;while(a>0&&" "!==r[a]&&r[a]!==o[0])a--;return a=a||n,r=r.slice(0,a),r+o};e["a"]=n},d246:function(t,e,o){"use strict";var i=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("h2",{staticClass:"h1",attrs:{id:"view-title"}},[t._t("default")],2)},n=[],r={name:"ViewTitle"},a=r,s=(o("0a25"),o("2877")),l=Object(s["a"])(a,i,n,!1,null,null,null);e["a"]=l.exports},d784:function(t,e,o){"use strict";o("ac1f");var i=o("6eeb"),n=o("d039"),r=o("b622"),a=o("9263"),s=o("9112"),l=r("species"),c=!n((function(){var t=/./;return t.exec=function(){var t=[];return t.groups={a:"7"},t},"7"!=="".replace(t,"$<a>")})),u=function(){return"$0"==="a".replace(/./,"$0")}(),d=r("replace"),b=function(){return!!/./[d]&&""===/./[d]("a","$0")}(),f=!n((function(){var t=/(?:)/,e=t.exec;t.exec=function(){return e.apply(this,arguments)};var o="ab".split(t);return 2!==o.length||"a"!==o[0]||"b"!==o[1]}));t.exports=function(t,e,o,d){var g=r(t),p=!n((function(){var e={};return e[g]=function(){return 7},7!=""[t](e)})),h=p&&!n((function(){var e=!1,o=/a/;return"split"===t&&(o={},o.constructor={},o.constructor[l]=function(){return o},o.flags="",o[g]=/./[g]),o.exec=function(){return e=!0,null},o[g](""),!e}));if(!p||!h||"replace"===t&&(!c||!u||b)||"split"===t&&!f){var v=/./[g],m=o(g,""[t],(function(t,e,o,i,n){return e.exec===a?p&&!n?{done:!0,value:v.call(e,o,i)}:{done:!0,value:t.call(o,e,i)}:{done:!1}}),{REPLACE_KEEPS_$0:u,REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE:b}),k=m[0],E=m[1];i(String.prototype,t,k),i(RegExp.prototype,g,2==e?function(t,e){return E.call(t,this,e)}:function(t){return E.call(t,this)})}d&&s(RegExp.prototype[g],"sham",!0)}},dcf9:function(t,e,o){},f36d:function(t,e,o){"use strict";o("dcf9")}}]);
//# sourceMappingURL=chunk-7d848584.66693694.js.map